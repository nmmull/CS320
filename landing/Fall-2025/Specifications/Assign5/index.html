<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Assign5 (Fall-2025.Specifications.Assign5)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" href="../../../odoc.support/katex.min.css"/><script src="../../../odoc.support/katex.min.js"></script><script>
//<![CDATA[

          document.addEventListener("DOMContentLoaded", function () {
            var elements = Array.from(document.getElementsByClassName("odoc-katex-math"));
            for (var i = 0; i < elements.length; i++) {
              var el = elements[i];
              var content = el.textContent;
              var new_el = document.createElement("span");
              new_el.setAttribute("class", "odoc-katex-math-rendered");
              var display = el.classList.contains("display");
              katex.render(content, new_el, { throwOnError: false, displayMode: display });
              el.replaceWith(new_el);
            }
          });
        
//]]>
</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">Fall-2025</a> &#x00BB; <a href="../index.html">Specifications</a> &#x00BB; Assign5</nav><header class="odoc-preamble"><h1>Module <code><span>Specifications.Assign5</span></code></h1><p>This assignment is due on <b>Thursday 10/9 by 8:00PM</b>. You should put all of your programming solutions in a file called <code>assign5/lib/assign5.ml</code>. See the file <code>test/test_assign5.ml</code> for example behavior of each function. You should put all your written solutions in a single pdf file.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#programming-(50%)">Programming (50%)</a><ul><li><a href="#practice-problems-(ungraded)">Practice Problems (Ungraded)</a></li><li><a href="#basic-higher-order-functions">Basic Higher Order Functions</a></li><li><a href="#rose-trees">Rose Trees</a></li><li><a href="#transpilation">Transpilation</a></li></ul></li><li><a href="#written-(50%)">Written (50%)</a><ul><li><a href="#results">Results</a></li><li><a href="#if-without-else-expressions">If-Without-Else-Expressions</a></li></ul></li></ul></nav></div><div class="odoc-content"><h2 id="programming-(50%)"><a href="#programming-(50%)" class="anchor"></a>Programming (50%)</h2><h3 id="practice-problems-(ungraded)"><a href="#practice-problems-(ungraded)" class="anchor"></a>Practice Problems (Ungraded)</h3><p>These problems come from a list of <a href="https://ocaml.org/exercises">Exercises</a> on OCaml's webpage. We won't grade these (the solutions are given with the problem statements).</p><ul><li><a href="https://ocaml.org/exercises#15">Replicate the Elements of a List a Given Number of Times</a></li><li><a href="https://ocaml.org/exercises#16">Drop Every N'th Element From a List</a></li><li><a href="https://ocaml.org/exercises#22">Create a List Containing All Integers Within a Given Range</a></li></ul><p>Where possible, try to use higher-order functions, like <code>map</code> and <code>fold_left</code>.</p><h3 id="basic-higher-order-functions"><a href="#basic-higher-order-functions" class="anchor"></a>Basic Higher Order Functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-curry3"><a href="#val-curry3" class="anchor"></a><code><span><span class="keyword">val</span> curry3 : <span><span>(<span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'d</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'d</span></span></code></div><div class="spec-doc"><p>Implement the function <code>curry3</code> which converts a &quot;multi-argument&quot; function (i.e., a function which takes a tuple as an argument) into nested single-argument functions.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-uncurry3"><a href="#val-uncurry3" class="anchor"></a><code><span><span class="keyword">val</span> uncurry3 : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'d</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'d</span></span></code></div><div class="spec-doc"><p>Implement the function <code>uncurry3</code>, which is the inverse of <code>curry3</code>, i.e., it converts a Curried three-argument function into a function which take a tuple as an argument.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-filter_map"><a href="#val-filter_map" class="anchor"></a><code><span><span class="keyword">val</span> filter_map : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> option</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> list</span></span></code></div><div class="spec-doc"><p>Implement the function <code>filter_map</code> so that <code>filter_map p l</code> is the result of applying <code>p</code> to every element of <code>l</code>, filtering out the <code>None</code> elements, and keeping only the arguments to the <code>Some</code> elements.</p></div></div><h3 id="rose-trees"><a href="#rose-trees" class="anchor"></a>Rose Trees</h3><div class="odoc-spec"><div class="spec type anchored" id="type-rtree"><a href="#type-rtree" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a rtree</span></span><span> = </span></code><ol><li id="type-rtree.Node" class="def variant constructor anchored"><a href="#type-rtree.Node" class="anchor"></a><code><span>| </span><span><span class="constructor">Node</span> <span class="keyword">of</span> <span class="type-var">'a</span> * <span><span><span class="type-var">'a</span> <a href="#type-rtree">rtree</a></span> list</span></span></code></li></ol></div></div><p><b>Rose trees</b> are represented by an ADT with a single constructor, a <code>Node</code> with a value and a list of children. Note that it is possible for a <code>Node</code> to have no children. An example:</p><pre class="language-ocaml"><code>  let example : int rtree =
    Node
      ( 1
      , [
          Node (2, []);
          Node (3, [Node 4 []; Node 5 []]);
          Node (6, []);
        ]
      )</code></pre><div class="odoc-spec"><div class="spec value anchored" id="val-map_rtree"><a href="#val-map_rtree" class="anchor"></a><code><span><span class="keyword">val</span> map_rtree : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-rtree">rtree</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-rtree">rtree</a></span></span></code></div><div class="spec-doc"><p>Implement <code>map_rtree</code> so that <code>map_rtree f t</code> is the result of applying <code>f</code> every value of <code>t</code>, maintaining the structure of <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-filter_rtree"><a href="#val-filter_rtree" class="anchor"></a><code><span><span class="keyword">val</span> filter_rtree : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-rtree">rtree</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-rtree">rtree</a></span> option</span></span></code></div><div class="spec-doc"><p>Implement <code>filter_rtree</code> so that <code>filter_rtree f t</code> is the result to filtering out those value <code>v</code> of <code>t</code> for which <code>f v = false</code>. In particular, for a subtree <code>Node (v, ts)</code>, if <code>f v = false</code> then <i>the whole subtree</i> should be removed.</p></div></div><h3 id="transpilation"><a href="#transpilation" class="anchor"></a>Transpilation</h3><p>Suppose you want to implement a programming language with an fancy type system and some cool new compile-time-checked features, but which is semantically identical to Python. In this kind of scenario, instead of building an evaluator for your programming language, you can just <i>translate</i> programs in your language into Python programs and then run those.</p><p>This may seem a bit silly (implementing a programming language that's essentially a &quot;wrapper&quot; for another programming language) but it's not an uncommon practice. Typescript, for example, is essentially a superset of JavaScript which gets checked at compile time and then translated into JavaScript. Elm is another programming language that transpiles to JavaScript, but in a functional (i.e., better) way. There are a number of reasons to do this, but the main reason is that we might want to run the programs we write in a particular programming ecosystem, but also want the guarantees that come from the type checker (or whatever else) we implement.</p><p>Consider the following collection of ADTs representing a toy imperative program.</p><div class="odoc-spec"><div class="spec type anchored" id="type-op"><a href="#type-op" class="anchor"></a><code><span><span class="keyword">type</span> op</span><span> = </span></code><ol><li id="type-op.Add" class="def variant constructor anchored"><a href="#type-op.Add" class="anchor"></a><code><span>| </span><span><span class="constructor">Add</span></span></code></li><li id="type-op.Sub" class="def variant constructor anchored"><a href="#type-op.Sub" class="anchor"></a><code><span>| </span><span><span class="constructor">Sub</span></span></code></li><li id="type-op.Mul" class="def variant constructor anchored"><a href="#type-op.Mul" class="anchor"></a><code><span>| </span><span><span class="constructor">Mul</span></span></code></li><li id="type-op.Div" class="def variant constructor anchored"><a href="#type-op.Div" class="anchor"></a><code><span>| </span><span><span class="constructor">Div</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-expr"><a href="#type-expr" class="anchor"></a><code><span><span class="keyword">type</span> expr</span><span> = </span></code><ol><li id="type-expr.Int" class="def variant constructor anchored"><a href="#type-expr.Int" class="anchor"></a><code><span>| </span><span><span class="constructor">Int</span> <span class="keyword">of</span> int</span></code></li><li id="type-expr.Var" class="def variant constructor anchored"><a href="#type-expr.Var" class="anchor"></a><code><span>| </span><span><span class="constructor">Var</span> <span class="keyword">of</span> string</span></code></li><li id="type-expr.Call" class="def variant constructor anchored"><a href="#type-expr.Call" class="anchor"></a><code><span>| </span><span><span class="constructor">Call</span> <span class="keyword">of</span> string * <span><a href="#type-expr">expr</a> list</span></span></code></li><li id="type-expr.Bop" class="def variant constructor anchored"><a href="#type-expr.Bop" class="anchor"></a><code><span>| </span><span><span class="constructor">Bop</span> <span class="keyword">of</span> <a href="#type-op">op</a> * <a href="#type-expr">expr</a> * <a href="#type-expr">expr</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-stmt"><a href="#type-stmt" class="anchor"></a><code><span><span class="keyword">type</span> stmt</span><span> = </span></code><ol><li id="type-stmt.FunDef" class="def variant constructor anchored"><a href="#type-stmt.FunDef" class="anchor"></a><code><span>| </span><span><span class="constructor">FunDef</span> <span class="keyword">of</span> string * <span>string list</span> * <span><a href="#type-stmt">stmt</a> list</span></span></code></li><li id="type-stmt.Assign" class="def variant constructor anchored"><a href="#type-stmt.Assign" class="anchor"></a><code><span>| </span><span><span class="constructor">Assign</span> <span class="keyword">of</span> string * <a href="#type-expr">expr</a></span></code></li><li id="type-stmt.Print" class="def variant constructor anchored"><a href="#type-stmt.Print" class="anchor"></a><code><span>| </span><span><span class="constructor">Print</span> <span class="keyword">of</span> <a href="#type-expr">expr</a></span></code></li><li id="type-stmt.Return" class="def variant constructor anchored"><a href="#type-stmt.Return" class="anchor"></a><code><span>| </span><span><span class="constructor">Return</span> <span class="keyword">of</span> <a href="#type-expr">expr</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-prog"><a href="#type-prog" class="anchor"></a><code><span><span class="keyword">type</span> prog</span><span> = <span><a href="#type-stmt">stmt</a> list</span></span></code></div></div><p>Here's an example of a program represented as a value of this ADT:</p><pre class="language-ocaml"><code>  let example : prog =
    [
      FunDef (&quot;foo&quot;, [&quot;x&quot;; &quot;y&quot;],
              [ Return (Bop (Add, Var &quot;x&quot;, Var &quot;y&quot;)) ]);
      FunDef (&quot;bar&quot;, [&quot;x&quot;],
              [ Assign (&quot;y&quot;, Bop (Mul, Int 2, Var &quot;x&quot;));
                Return (Bop (Mul, Var &quot;y&quot;, Var &quot;y&quot;));
              ]);
      Print (
        Bop
          (Sub
          , Call (&quot;foo&quot;, [Int 2; Int 3])
          , Call (&quot;bar&quot;, [Int 5])
          )
      )
    ]</code></pre><p>This program might get translated to Python as:</p><pre class="language-text"><code>def foo(x, y):
    return (x + y)
def bar(x):
    y = (2 * x)
    return (y * y)
print((foo(2, 3) - bar(5)))</code></pre><p>In this problem, you'll be implementing this translation.</p><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_expr"><a href="#val-string_of_expr" class="anchor"></a><code><span><span class="keyword">val</span> string_of_expr : <span><a href="#type-expr">expr</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Implement the function <code>string_of_expr</code> so that <code>string_of_expr e</code> is a string represent of <code>e</code> as a Python expression. In order to make things simple, you must:</p><ul><li>wrap every binary operator in parentheses;</li><li>use exactly 1 space around binary operators;</li><li>use exactly 1 space after commas;</li><li>otherwise, use no whitespace.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_stmt"><a href="#val-string_of_stmt" class="anchor"></a><code><span><span class="keyword">val</span> string_of_stmt : <span><a href="#type-stmt">stmt</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Implement the function <code>string_of_stmt</code> so that <code>string_of_stmt s</code> is a string representation of <code>s</code> as a Python statement. In order to make things simpler, you must:</p><ul><li>use exactly 1 space after the keyword <code>return</code>;</li><li>use exactly 1 space after the keyword <code>def</code>;</li><li>use exactly 1 space after commas;</li><li>use exactly 1 space around the assignment operator <code>=</code>;</li><li>separate each function statement with a single line break;</li><li>use 4 spaces for indenting the body of a function;</li><li>otherwise use no whitespace (except for what is also required by expressions).</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_prog"><a href="#val-string_of_prog" class="anchor"></a><code><span><span class="keyword">val</span> string_of_prog : <span><a href="#type-prog">prog</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Implement the function <code>string_of_prog</code> so that <code>string_of_prog p</code> is a string representation of <code>p</code> as Python program. In order to make things simpler, you must:</p><ul><li>separate every statement with a single line break.</li><li>otherwise use no white space (except for what is also required by expressions and statements).</li></ul></div></div><p>A couple closing comments:</p><ul><li>Make sure to take a look at the test cases. These are going to be the most useful for checking your solution.</li><li>The most difficult part will be dealing with indentation. Remember that functions can be nested!</li><li>Make sure to look at the <code>String</code> module in the standard library for potentially useful functions.</li></ul><h2 id="written-(50%)"><a href="#written-(50%)" class="anchor"></a>Written (50%)</h2><h3 id="results"><a href="#results" class="anchor"></a>Results</h3><p>We saw the syntax, typing rules, and semantic rules for options and option matching during lab. <b>The Task:</b> Write the syntax, typing rules, and semantic rules for results and result matching, in analogy with the rules for options. Your semantic rules should introduce new values of the form <code class="odoc-katex-math">\mathsf{Ok}(v)</code> and <code class="odoc-katex-math">\mathsf{Error}(v)</code> (where <code class="odoc-katex-math">v</code> can be any value).</p><p>Use these rules to give derivations for the following judgments.</p><div><pre class="odoc-katex-math display">    \{ \texttt{r} : \texttt{(int, bool) result} \} \vdash \texttt{match r with | Ok x -&gt; Error (x + 1) | Error b -&gt; Ok b} : \texttt{(bool, int) result}
    </pre></div><div><pre class="odoc-katex-math display">    \texttt{match Ok (1 + 1) with | Ok x -&gt; Error (x + 1) | Error b -&gt; Ok b} \Downarrow \mathsf{Error}(3)
    </pre></div><h3 id="if-without-else-expressions"><a href="#if-without-else-expressions" class="anchor"></a>If-Without-Else-Expressions</h3><p>Many programming languages support if-statements without else-branches. This isn't exactly possible in OCaml because every expression must have a value, including if-expression. Without an else-branch, it's not clear what the value of an if-expression would be.</p><p>One possibility is to let the value of an if-without-else-expression be an option, and let the implicit else-branch have the value <code>None</code>. Suppose we wanted to introduce this language construct to OCaml, with the syntax:</p><pre class="language-ocaml"><code>&lt;expr&gt; ::= if &lt;expr&gt; then &lt;expr&gt;</code></pre><p>so that the typing and semantic behavior of</p><div><pre class="odoc-katex-math display">   \texttt{if } e_1 \texttt{ then } e_2
   </pre></div><p>is exactly the same as the typing and semantic behavior of</p><div><pre class="odoc-katex-math display">   \texttt{if } e_1 \texttt{ then Some } e_2 \texttt{ else None}
   </pre></div><p>Write the typing and semantic rules for if-without-else-expressions, and then give derivations of the following judgments:</p><div><pre class="odoc-katex-math display">   \varnothing \vdash \texttt{match if true then 1 with | None -&gt; 2 | Some x -&gt; x + 1} : \texttt{int}
   </pre></div><div><pre class="odoc-katex-math display">   \texttt{match if true then 1 with | None -&gt; 2 | Some x -&gt; x + 1} \Downarrow 2
   </pre></div></div></body></html>
